\documentclass[11pt,a4paper]{article}

\usepackage{english}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\title{DEStrategy}
\author{Micha≈Ç Sypetkowski, Marcin Waszak}
\date{}

\begin{document}
\maketitle

\begin{abstract}
An python library which implements DES algorithm desribed in detail in this article: https://pzawistowski.github.io/assets/wae/DES.pdf.
\end{abstract}

\section{General Algorithm Description}\label{sec:general}

\subsection{Offspring generation}\label{subsec:offspring}

$\lambda$ is initial population size.
After each iteration algoritm maintains $\lambda$ individuals.
At the beggining of an iteration, $\mu$ best individuals are selected.
Next population is randomized in a way, so that result is similar (but different) to sampling $\lambda$ vectors with the mean $s$ and following covariance matrix:
\begin{equation}
    D' = \frac{1}{\mu} \sum_{i=1}^{\mu} (O_i - m)(O_i - m)^T,
    \label{eqn:equa1}
\end{equation}
where $O_i$ are individuals (vectors) from current populations, and $m$ is current population midpoint.
This is used in CMA-ES algorithm as covariance matrix of a new population.
DES don't use this matrix directly to generate new vectors like CMA-ES.

To generate new individuals with mean $s$ and new covariance matrix $D'$, we can use following formula:
\begin{equation}
    x = s + \frac{1}{\sqrt2}(O_i - O_j) + a\Delta
\end{equation}
where $s$ is midpoint of a population of best $\mu$ individuals,
$O_i$ and $O_j$ are individuals selected independently with uniform distribution from the population of best $\mu$ individuals,
$a \sim N(0,1)$ is standardized scalar normal variate,
and $\Delta=s-m$.

DES algorithm modifies elements of this equasion.
Factor $\frac{1}{\sqrt2}$ is replaced with constant F, which is a parameter of the algorithm.
$O_i$ and $O_j$ are selected from best $\mu$ individuals of population $t-h$, where $t$ is current population number, and $h \sim U(0, ..., H-1)$
$H$ constant is a parameter of the algorithm.
$\Delta$ is accumulated shift of population midpoint
$\Delta(t+1) \leftarrow (1-c)\cdot\Delta(t)+c)\cdot(s(t)-m(t))$.
$c$ is midpoint smootching factor.
Additionally DES adds to new individual a noise proportional to current $\Delta$.

To sum up, DES has 6 configurable parameters:
\begin{enumerate}
\item $\lambda$ - population size
\item $\mu$ - offspring number
\item $F$ - scaling factor
\item $c$ - midpoint smootching factor.
\item $H$ - time horizon for archive
\item $\epsilon$ - noise intensity
\end{enumerate}

\subsection{Boundary constraints handling}\label{subsec:constraints}

Boundary constraints are handled by a penalty function technique.
Library will use by default quadratic penalty function that takes into account all coordinates for which boundary constraints are violated.
Library also enables user to pass an custom penalty function.

\subsection{Stop criterion}\label{subsec:stop}
User decides when to stop iteration.
Library provides medium standard deviation of population (from medium point of previous population).
Low value suggests that the changes are small and further iterations won't affect the result significantly.

\section{Python API}\label{sec:api}
API consist of only one generator:


\begin{lstlisting}[language=Python]

DEStrategy(
    # obligatory parameters
    n,
    targetFun,

    # optional parameters
    lambd=None, # default: 4*n
    mu=None, # default: lambda/2
    F=1/(2**0.5),
    c=None, # default: 4/(n+4)
    H=None, # default: 6 + 3*sqrt(n)
    e=None, # default:
            # 10^(-8) / ExpectedLength(N(0,I))
    penaltyFun=None, # default:
                     # sum of squared trangressions
                     # (for each diension)

    # at least one of these is obligatory
    initialPopulation=None: # default:
                    # uniform random inside boundaries
    boundaries=None, #default:
                    # each dimension from -inf to +inf

)

\end{lstlisting}

Generator yields tuples of 2 elements:
Current population and medium standard deviation of population (see 1.3 Stop criterion)

Example usage:
\begin{lstlisting}[language=Python]
for population, meanStddev in DEStrategy(
        n=2,
        targetFun=lambda x,y: sin(x) + sin(y),
        boundaries=[(-1000, 1000), (-1000, 1000)],
        ):
    print("Current population:", population)
    if meanStddev < 0.01:
        break
\end{lstlisting}




\end{document}
